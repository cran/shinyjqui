shinyjqui=function(){var getInputContainer=function(e){var t=$(e).closest(".shiny-input-container");return t.length?t.get(0):e},regShinyInput=function(e,t,n){$.each(n,function(n,r){var i=t+"_"+n;$.each(r,function(t,n){$(e).on(t,function(e,t){var r=n(e,t);Shiny.onInputChange(i,r)})})})},handleShinyInput=function(e,t,n){var r=shinyjqui.getId(e);if(r){if(t&&t.hasOwnProperty("shiny")){var i=Object.keys(n);$.each(i,function(e,r){$.inArray(r.replace(/:.+/,""),Object.keys(t.shiny))>=0&&delete n[r]}),$.extend(n,t.shiny),delete t.shiny}regShinyInput(e,r,n)}},evaluateJSExpressions=function(opt,idx){$.each(idx,function(key,value){value===!0&&opt[key]?opt[key]=eval("("+opt[key]+")"):"object"==typeof value&&evaluateJSExpressions(opt[key],value)})},evalJS=function(e){var t=e._js_idx;return t&&"object"==typeof t&&evaluateJSExpressions(e,t),e},checkResizableWrapper=function(e){return $(e).parent().hasClass("jqui-resizable-wrapper")&&(e=$(e).parent().get(0)),e},interactions={draggable:{enable:function(e,t){var n=function(e,t){return $(e.target).position()},r={position:{dragcreate:n,drag:n},is_dragging:{dragcreate:function(e,t){return!1},dragstart:function(e,t){return!0},dragstop:function(e,t){return!1}}};e=checkResizableWrapper(e),handleShinyInput(e,t,r),$(e).draggable(t)},disable:function(e){e=getInputContainer(e),$(e).draggable("destroy")}},droppable:{enable:function(e,t){e=getInputContainer(e);var n={over:{dropcreate:function(e,t){return[]},dropover:function(e,t){return shinyjqui.getId(t.draggable.get(0))}},drop:{dropcreate:function(e,t){return[]},drop:function(e,t){return shinyjqui.getId(t.draggable.get(0))}},out:{dropcreate:function(e,t){return[]},dropout:function(e,t){return shinyjqui.getId(t.draggable.get(0))}},dragging:{dropcreate:function(e,t){return[]},dropactivate:function(e,t){return shinyjqui.getId(t.draggable.get(0))},dropdeactivate:function(e,t){return[]}},dropped:{dropcreate:function(e,t){return $(e.target).data("shinyjqui_droppedIds",[]),[]},drop:function(e,t){var n=$(e.target).data("shinyjqui_droppedIds"),r=shinyjqui.getId(t.draggable.get(0));return-1==$.inArray(r,n)&&n.push(r),$(e.target).data("shinyjqui_droppedIds",n),n},dropout:function(e,t){var n=$(e.target).data("shinyjqui_droppedIds"),r=shinyjqui.getId(t.draggable.get(0));return n.splice($.inArray(r,n),1),$(e.target).data("shinyjqui_droppedIds",n),n}}};e=checkResizableWrapper(e),handleShinyInput(e,t,n),$(e).droppable(t)},disable:function(e){e=getInputContainer(e),$(e).droppable("destroy")}},resizable:{enable:function(e,t){if(!$(e).parent().hasClass("ui-resizable")){if(/action-button|html-widget-output|shiny-.+?-output/.test($(e).attr("class"))){var n=$("<div></div>").outerWidth($(e).outerWidth()?$(e).outerWidth():"100%").outerHeight($(e).outerHeight()?$(e).outerHeight():"100%").addClass("jqui-resizable-wrapper"),r=$(e).wrap(n).outerWidth("100%").outerHeight("100%").parent().get(0),i=$(e).data("shinyjqui_options");$(r).data("shinyjqui_options",{}),$.each(i,function(t,n){interactions[t].enable(r,n),interactions[t].disable(e),$(r).data("shinyjqui_options")[t]=n}),$(e).data("shinyjqui_options",{}),e=r}var o={size:{resizecreate:function(e,t){return{width:$(e.target).width(),height:$(e.target).height()}},resize:function(e,t){return t.size}},is_resizing:{resizecreate:function(e,t){return!1},resizestart:function(e,t){return!0},resizestop:function(e,t){return!1}}};handleShinyInput(e,t,o),$(e).resizable(t)}},disable:function(e){var t=$(e).parent(".ui-resizable");t.length?(t.resizable("destroy"),$(e).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).insertAfter(t),t.remove()):$(e).resizable("destroy")}},selectable:{enable:function(e,t){var n=function(e,t){var n=$(e.target).children(".ui-selected"),r=n.map(function(e,t){return t.innerHTML}).get(),i=n.map(function(e,t){return shinyjqui.getId(t)}).get();return{id:i,html:r}},r={"selected:shinyjqui.df":{selectablecreate:n,selectablestop:n},is_selecting:{selectablecreate:function(e,t){return!1},selectablestart:function(e,t){return!0},selectablestop:function(e,t){return!1}}};e=checkResizableWrapper(e),handleShinyInput(e,t,r),$(e).selectable(t)},disable:function(e){$(e).selectable("destroy")}},sortable:{enable:function(e,t){var n=function(e,t){var n=$(e.target).children(),r=n.map(function(e,t){return t.innerHTML}).get(),i=n.map(function(e,t){return shinyjqui.getId(t)}).get();return{id:i,html:r}},r={"order:shinyjqui.df":{sortcreate:n,sortupdate:n}};e=checkResizableWrapper(e),handleShinyInput(e,t,r),$(e).sortable(t)},disable:function(e){$(e).sortable("destroy")}}};return{getId:function(e){var t=$(e).attr("id");return t||($(e).hasClass("shiny-input-container")?t=$(e).find(".shiny-bound-input").attr("id"):$(e).hasClass("jqui-resizable-wrapper")&&(t=$(e).find(".shiny-bound-output").attr("id"))),t?t:""},msgCallback:function(e){if(!e.hasOwnProperty("selector"))return void console.warn("No selector found");var t=$(e.selector).map(function(e,t){return getInputContainer(t)});if(!e.hasOwnProperty("method"))return void console.warn("No method found");var n=e.method;if(!e.hasOwnProperty("func"))return void console.warn("No func found");var r=e.func;if(e=evalJS(e),"interaction"===n)t.removeClass(function(e,t){return(t.match(/(^|\s)jqui-interaction-\S+/g)||[]).join(" ")}),e["switch"]===!0?t.each(function(t,n){console.log("==================="),console.log("ENABLE: "+r),console.log("ELEMENT: "),console.log(n),console.log("OPTIONS: "),console.log(e.options),console.log("==================="),$(n).data("shinyjqui_options")||$(n).data("shinyjqui_options",{}),interactions[r].enable(n,e.options),$(n).data("shinyjqui_options")[r]=e.options}):e["switch"]===!1?t.each(function(e,t){console.log("==================="),console.log("DISABLE: "+r),console.log("ELEMENT: "),console.log(t),console.log("==================="),$(t).data("shinyjqui_options")||$(t).data("shinyjqui_options",{}),interactions[r].disable(t),delete $(t).data("shinyjqui_options")[r]}):console.warn("Invalid switch: "+e["switch"]);else if("effect"===n){if(!e.hasOwnProperty("effect"))return void console.warn("No effect found. Action abort.");if("transfer"===e.effect&&("hide"===r||"show"===r||"toggle"===r))return void console.warn("The transfer effect cannot be used in hide/show. Action abort.");t[r](e.effect,e.options,e.duration,e.complete)}else if("class"===n)if("add"===r||"remove"===r){if(!e.hasOwnProperty("className"))return void console.warn("No className found");t[r+"Class"](e.className,e.duration,e.easing,e.complete)}else if("switch"===r){if(!e.hasOwnProperty("removeClassName"))return void console.warn("No removeClassName found");if(!e.hasOwnProperty("addClassName"))return void console.warn("No addClassName found");t[r+"Class"](e.removeClassName,e.addClassName,e.duration,e.easing,e.complete)}else console.warn("Invalid func: "+e.func);else console.warn("Invalid method: "+e.method)},init:function(){Shiny.addCustomMessageHandler("shinyjqui",shinyjqui.msgCallback)}}}(),$(function(){shinyjqui.init()});